!function(e){"use strict";function n(e,n){return 0===toString.call(n).indexOf("[object "+e)}function r(e){return u[e]?new Promise(function(n){u[e].on("ready",function(){n(u[e])}).on("error",function(n){reject(new Error("error initializing node ["+e+"]: "+n))})}):d[e]?d[e]:(d[e]=new Promise(function(n,r){if(!f[e])return void r(new Error("node load paths not defined ["+e+"]"));var o=f[e].length;f[e].forEach(function(i){t(i,function(t){return t.success?(o--,void(o||(u[e]?u[e].on("ready",function(){n(u[e])}).on("error",function(n){r(new Error("error initializing node ["+e+"]: "+n))}):r(new Error("node not defined ["+e+"]"))))):void r(new Error("could not load ["+i+"] of node ["+e+"]"))})})}),d[e])}function t(n,r){function t(n){n=n||e.event;var t="addEventListener"in e?{}:{loaded:1,complete:1};("load"==n.type||t[i.readyState])&&(i.onload=i.onreadystatechange=i.onerror="",r({success:!0}))}function o(e){r({success:!1,message:"error: requesting url ["+n+"]"})}var i=g.createElement("script");i.onload=i.onreadystatechange=t,i.onerror=o,i.type="text/javascript",i.charset="utf-8",i.async=!0,i.src=n;var a=g.getElementsByTagName("script")[0];a.parentNode.insertBefore(i,a)}function o(e,n){l[e]?(l[e].triggered=!0,l[e].payload=n,l[e].callbacks&&l[e].callbacks.forEach(function(e){e(n)})):l[e]={triggered:!0}}function i(e,n){l[e]?l[e].triggered?n(l[e].payload):l[e].callbacks.push(n):l[e]={triggered:!1,callbacks:[n]}}var a="0.0.1",c={},s=0,u={},d={},f={},l={},g=e.document,p=e.setTimeout,h=e.XI=e.Îž=function(e,t,d){var f={_version:a,_id:s++,_messages:[],_dependencies:{}};n("String",e)?(f.name=e,u[e]=f):(f.name="anonymous"+f._id,t=arguments[0],d=arguments[1]),n("Array",t)||(d=t,t=[]),f.on=function(e,n){return i(f.name+"@"+e,n),f},f.trigger=function(e,n){return o(f.name+"@"+e,n),f},i("document-runnable",function(){var e=t.length;t.length?t.forEach(function(n){r(n).then(function(r){f._dependencies[n]=r,e--,e||f.trigger("ready")})["catch"](function(e){f._messages.push(e),f.trigger("error",e)})}):f.trigger("ready")});for(var l in d)d.hasOwnProperty(l)&&(c[l]&&c[l].call(f,d[l]),f[l]=d[l]);return f};h._version=a,h.register=function(e,n){"function"==typeof n?c[e]=n:this.node._messages.push("handler: registered without callback function ["+e+"]")},h.paths=function(n){if(!n.XI)throw Error("path to XI folder not defined");f=n,f["XI.streams"]=[n.XI+"/streams.XI.js"],e.Promise?o("runnable"):t(f.XI+"/promise.XI.js",!1,function(e){if(!e.success)throw Error("could not load promise polyfill ... stoppping execution");o("runnable")})},e.addEventListener("load",function(){p(function(){o("document-runnable")},0)}),h.register("run",function(e){var n=this;p(function(){try{e.call(n)}catch(r){n.trigger("error",r)}})}),h.register("ready",function(e){var n=this,r=[];n.on("ready",function(){try{for(var t in n._dependencies)n._dependencies.hasOwnProperty(t)&&r.push(n._dependencies[t]);e.apply(n,r)}catch(o){n.trigger("error",o)}})})}(this);